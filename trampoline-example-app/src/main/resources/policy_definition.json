{
  "policies": [
    {
      "name": "Admin override",
      "description": "Allow all for ROLE_ADMIN",
      "target": "hasRole('ROLE_ADMIN')",
      "condition": "true"
    },
    {
      "name": "View WHOAMI page",
      "description": "View GET /whoami",
      "target": "isAction('WHO_AM_I')",
      "condition": "hasAuthority('WHOAMI_GET')"
    },
    {
      "name": "View protected ping page",
      "description": "View GET /ping/protected",
      "target": "isAction('PING_PROTECTED')",
      "condition": "hasAuthority('PING_PROTECTED')"
    },
    {
      "name": "View blog list",
      "description": "View GET /blogs",
      "target": "isAction('BLOGPOST_LIST')",
      "condition": "hasRole('ROLE_USER')"
    },
    {
      "name": "Create blog post entry",
      "description": "Do POST /blogs",
      "target": "isAction('BLOGPOST_CREATE')",
      "condition": "hasRole('ROLE_USER')"
    },
    {
      "name": "View blogpost",
      "description": "View GET /blogs/{id}",
      "target": "isAction('BLOGPOST_VIEW')",
      "condition": "hasRole('ROLE_USER')"
    },
    {
      "name": "Delete blogpost",
      "description": "Do DELETE /blogs/{id}",
      "target": "isAction('BLOGPOST_DELETE')",
      "condition": "hasRole('ROLE_USER') && resource.author.id == subject.id"
    },
    {
      "name": "Patch blogpost",
      "description": "Do PATCH /blogs/{id}",
      "target": "isAction('BLOGPOST_EDIT')",
      "condition": "hasRole('ROLE_USER') && resource.author.id == subject.id"
    }
  ]
}