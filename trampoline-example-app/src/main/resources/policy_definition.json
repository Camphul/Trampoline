{
  "policies": [
    {
      "name": "SuperAdmin override",
      "description": "Allow all for ROLE_SUPERADMIN",
      "target": "hasRole('ROLE_SUPERADMIN')",
      "condition": "true"
    },
    {
      "name": "Book delete",
      "description": "Delete books",
      "target": "isAction('BOOKS_DELETE')",
      "condition": "resource.author.id == subject.id"
    },
    {
      "name": "Book list admin",
      "description": "Override normal book list policy for admin users",
      "target": "isAction('BOOKS_LIST') && hasRole('ROLE_ADMIN')",
      "condition": "true"
    },
    {
      "name": "View book list",
      "description": "PM read the details of his project only.",
      "target": "isAction('BOOKS_LIST')",
      "condition": "resource.author == subject.id && hasAuthority('BOOK_READ')"
    },
    {
      "name": "View WHOAMI page",
      "description": "/whoami endpoint access",
      "target": "isAction('WHO_AM_I')",
      "condition": "hasRole('ROLE_USER')"
    }
  ]
}